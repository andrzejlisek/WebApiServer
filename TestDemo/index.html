<!doctype html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Test</title>
  </head>
  <body>
    <div id="textcontent"></div>
    <input type="text" id="SrvPort" value="ws://localhost:8888" size="20">
    <input type="button" value="Open" onclick="AppOpen()">
    <input type="button" value="Close" onclick="AppClose()">
    
    <br>
    <br>
    <input type="text" id="FileName" size="50">
    <input type="button" value="Load" onclick="FileLoad()">
    <input type="button" value="Save" onclick="FileSave()">
    <input type="button" value="Delete" onclick="FileDelete()">
    <input type="button" value="Dir" onclick="GetFilesBtn()">
    <br>
    <br>
    <input type="text" id="ConnAddr" size="50" value="/usr/bin/telnet localhost">
    <input type="button" value="Open" onclick="BtnConnOpen()">
    <input type="button" value="Status" onclick="BtnConnInfo()">
    <input type="button" value="Close" onclick="BtnConnClose()">
    <input type="button" value="Send" onclick="BtnConnSend()">
    <input type="button" value="Recv" onclick="BtnConnRecv()">
    <br>
    <br>
    <input type="button" value="Test1" onclick="BtnTest(1)">
    <input type="button" value="Test2" onclick="BtnTest(2)">
    <input type="button" value="Test3" onclick="BtnTest(3)">
    <br>
    <textarea id="FileText" rows="10" cols="50"></textarea>
    <br>
    <br>

    <input type="text" id="FileFilter" value="^.*$" size="50">
    <div id="FileDemo"></div>

    <script type='text/javascript' src="demo.js"></script>
    <script type='text/javascript' src="WSIOKV.js"></script>
    <script type='text/javascript' src="WSIO.js"></script>
    <script type='text/javascript'></script>
    <script type='text/javascript'>
        // Create list of object members - https://flaviocopes.com/how-to-list-object-methods-javascript/
        function getMethods(obj)
        {
            let Names = Object.getOwnPropertyNames(obj);
            let MemberList = [];
            for (var Item in Names)
            {
                let Nx = Names[Item];
                if (obj.hasOwnProperty(Nx))
                {
                    if (Nx[0] == '_')
                    {
                        MemberList.push(Nx);
                    }
                }
            }
            return MemberList;
        }

        function Info(Msg)
        {
            document.getElementById("textcontent").innerHTML = document.getElementById("textcontent").innerHTML + Msg + "<br>";
        }
        
        let WSIO = "";
        
        function StartResult(Params)
        {
            switch (Params.Type)
            {
                case "WebSocket":
                    if (Params.Error)
                    {
                        Info("Server connection error" + Params.Error);
                    }
                    else
                    {
                        Info("Server is connected");
                    }
                    break;
                case "Connection":
                    Info(StringDecode(Params.Data));
                    break;
            }
        }
        
        function AppOpen()
        {
            WSIO = new WebSocketInputOutput(document.getElementById("SrvPort").value, 1000, StartResult);
        }

        function AppClose()
        {
            WSIO.Close();
        }
        
        AppOpen();

    </script>
  </body>
</html>
